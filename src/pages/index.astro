---
import Base from "../../src/layouts/Base.astro";
import fs from 'node:fs/promises';
import { getCollection } from 'astro:content';
const pageTitle = 'Kateiso · AI into XR & 餐饮数字化记录';
const pageDesc = '定居宁波，在威海攻读 Lancaster × 北京交通大学双学位，专注 AI into XR 与餐饮数字化。';
let gallery = [] as any[];
try {
  const raw = await fs.readFile('public/assets/data/gallery.json', 'utf8');
  const json = JSON.parse(raw);
  gallery = (json.items || []).slice(0, 6);
} catch {}
const posts = (await getCollection('posts')).sort((a,b) => (a.data.date < b.data.date ? 1 : -1)).slice(0, 3);
const portrait = '/assets/media/gallery/2025-05-23-vison-pro-at-jinan.jpeg';
const timeline = [
  { year: '2025', detail: 'Human AI Co-Memory 毕设进行中，聚焦 AI 在 XR 彩排中的垂直应用。' },
  { year: '2024', detail: '把餐饮数字化定为长期课题，TasteOS 与多家门店一起跑数据。' },
  { year: '2022', detail: '进入北京交通大学并加入 Lancaster 联合培养项目，主修信息管理。' },
  { year: '2003', detail: '出生于宁波，习惯把海风的节奏记下来。' }
];
const focusAreas = [
  {
    title: 'AI into XR',
    summary: 'AI 在 XR 场景下的垂直应用：Feel / Frame / Flow 仪式、体感评分、共记忆脚本。',
    link: '/projects.html'
  },
  {
    title: 'AI into 餐饮',
    summary: '做 AI 技术（LLM、Agent）在餐饮领域的垂直应用，把补货、排班与体验分串起来。',
    link: '/projects.html'
  }
];
const socials = [
  { name: 'Email', icon: '/assets/icons/mail.svg', href: 'mailto:C.yibo2@gmail.com' },
  { name: 'X', icon: '/assets/icons/x.svg', href: 'https://x.com/KateisoCao' },
  { name: 'Douyin', icon: '/assets/icons/douyin.svg', href: 'https://www.douyin.com/user/MS4wLjABAAAAHCcB9BtLlZP-iSutvkW8oHPPHeSj_IR9rBa5uIq0L3drZDGzCcLmAaTFCozmXLH5?from_tab_name=main' }
];
const jsonLd = {
  '@context': 'https://schema.org',
  '@type': 'WebPage',
  name: 'Kateiso',
  description: pageDesc,
  inLanguage: 'zh-Hans',
  url: 'https://kateiso.dev/index.html'
};
---
<Base
  title={pageTitle}
  description={pageDesc}
  lang="zh-Hans"
  canonical="/index.html"
  alternates={[{ href: '/en/index.html', hrefLang: 'en' }]}
  languageToggle={{ href: '/en/index.html', label: 'EN', ariaLabel: 'View English home' }}
  jsonLd={jsonLd}
>
  <section class="hero hero--profile" id="top">
    <div class="hero__portrait">
      <img src={portrait} alt="Kateiso" loading="lazy" />
    </div>
    <div class="hero__content">
      <p class="hero__kicker">Weihai Campus · Ningbo Home</p>
      <h1>Kateiso</h1>
      <p class="hero__subtitle">专注 AI into XR 与餐饮数字化，期待与你链接～</p>
      <div class="hero__actions">
        <a class="button button--primary" href="/projects.html">项目概览</a>
        <a class="button button--ghost" href="/blog.html">博客文章</a>
      </div>
      <ul class="hero__facts">
        <li>在威海求学，来自宁波</li>
        <li>Lancaster × BJTU 双学位 | XR & Ops</li>
        <li>邮箱 <a href="mailto:C.yibo2@gmail.com">C.yibo2@gmail.com</a></li>
      </ul>
    </div>
  </section>

  <section class="section" id="timeline">
    <div class="section__intro">
      <h2>节点记录</h2>
    </div>
    <div class="timeline">
      {timeline.map((item) => (
        <article class="timeline__item">
          <span class="timeline__year">{item.year}</span>
          <p>{item.detail}</p>
        </article>
      ))}
    </div>
  </section>

  <section class="section" id="focus">
    <div class="section__intro">
      <h2>目前关注</h2>
    </div>
    <div class="highlight-grid">
      {focusAreas.map((item) => (
        <article class="highlight-card">
          <h3><a href={item.link}>{item.title}</a></h3>
          <p>{item.summary}</p>
        </article>
      ))}
    </div>
  </section>

  {gallery.length > 0 && (
    <section class="section" id="moments">
      <div class="section__intro section__intro--split">
        <div>
          <h2>近期瞬间</h2>
          <p class="section__lede">用共享 manifest 记录生活与创作。</p>
        </div>
        <a class="section__link" href="/photos.html">进入相册 →</a>
      </div>
      <div class="gallery-grid home-gallery">
        {gallery.map((it) => (
          <figure class="gallery-item">
            {it.video ? (
              <video class="gallery-item__media" src={it.video} poster={it.image} muted playsinline preload="metadata" loop></video>
            ) : (
              <img class="gallery-item__media" src={it.image} alt={it.title} loading="lazy" />
            )}
            <figcaption class="gallery-item__meta">
              <span class="gallery-item__date">{it.date}</span>
              <span aria-hidden="true">·</span>
              <span class="gallery-item__title">{it.title}</span>
            </figcaption>
          </figure>
        ))}
      </div>
    </section>
  )}

  <section class="section section--alt" id="journal">
    <div class="section__intro section__intro--split">
      <div>
        <h2>最新博客</h2>
        <p class="section__lede">记录实验与日常思考。</p>
      </div>
      <a class="section__link" href="/blog.html">查看博客 →</a>
    </div>
    <div class="journal-grid">
      {posts.map((post) => (
        <article class="journal-card">
          <p class="journal-card__meta">{new Date(post.data.date).toLocaleDateString('zh-CN', { year: 'numeric', month: 'long' })} · {post.data.type}</p>
          <h3><a href={`/blog/posts/${post.slug}.html`}>{post.data.title}</a></h3>
          <p class="journal-card__summary">{post.data.summary}</p>
        </article>
      ))}
    </div>
  </section>

  <section class="section" id="cta">
    <div class="contact-card">
      <p class="contact-card__label">下一步</p>
      <h2>一起把现实写进系统</h2>
      <p>邮件是我最专注的沟通方式，欢迎聊 XR 排练、餐饮数字化、合作与演讲。</p>
      <div class="contact-card__actions">
        <a class="button button--primary" href="mailto:C.yibo2@gmail.com">发邮件</a>
        <a class="button button--ghost" href="/contact.html">查看更多联系方式</a>
      </div>
      <div class="social-links" aria-label="社交媒体">
        {socials.map((item) => (
          <a class="social-link" href={item.href} target={item.href.startsWith('http') ? '_blank' : undefined} rel="noopener" aria-label={item.name}>
            <img src={item.icon} alt="" aria-hidden="true" />
          </a>
        ))}
      </div>
    </div>
  </section>
</Base>
