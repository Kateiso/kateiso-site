---
import Base from "../../../src/layouts/Base.astro";
import fs from 'node:fs/promises';
import { getCollection } from 'astro:content';
const pageTitle = 'Kateiso · AI into XR & Hospitality Ops';
const pageDesc = 'Based in Ningbo, studying in Weihai via the Lancaster × BJTU dual degree, translating AI thinking into XR rehearsals and restaurant systems.';
let gallery = [] as any[];
try {
  const raw = await fs.readFile('public/assets/data/gallery.json', 'utf8');
  const json = JSON.parse(raw);
  gallery = (json.items || []).slice(0, 6);
} catch {}
const postsEn = await getCollection('postsEn');
const fallback = postsEn.length === 0;
const postsSource = fallback ? await getCollection('posts') : postsEn;
const posts = postsSource.sort((a,b) => (a.data.date < b.data.date ? 1 : -1)).slice(0, 3);
const portrait = '/assets/media/gallery/2025-05-23-vison-pro-at-jinan.jpeg';
const timeline = [
  { year: '2025', detail: 'Human AI Co-Memory thesis focusing on vertical AI inside XR rehearsals.' },
  { year: '2024', detail: 'Pursued hospitality digitisation full time, launching TasteOS pilots with restaurants.' },
  { year: '2022', detail: 'Joined Beijing Jiaotong University and the Lancaster dual-degree track (Information Management).' },
  { year: '2003', detail: 'Born in Ningbo, a coastal city that taught me to respect tempo.' }
];
const focusAreas = [
  { title: 'AI into XR', summary: 'Vertical AI applications for XR—Feel/Frame/Flow rituals, motion scoring, empathy meters.', link: '/en/projects.html' },
  { title: 'AI into dining', summary: 'LLM + agent workflows for restaurants, bridging supply, prep, and guest feedback.', link: '/en/projects.html' }
];
const socials = [
  { name: 'Email', icon: '/assets/icons/mail.svg', href: 'mailto:C.yibo2@gmail.com' },
  { name: 'X', icon: '/assets/icons/x.svg', href: 'https://x.com/KateisoCao' },
  { name: 'Douyin', icon: '/assets/icons/douyin.svg', href: 'https://www.douyin.com/user/MS4wLjABAAAAHCcB9BtLlZP-iSutvkW8oHPPHeSj_IR9rBa5uIq0L3drZDGzCcLmAaTFCozmXLH5?from_tab_name=main' }
];
const jsonLd = {
  '@context': 'https://schema.org',
  '@type': 'WebPage',
  name: 'Kateiso · EN',
  description: pageDesc,
  inLanguage: 'en',
  url: 'https://kateiso.dev/en/index.html'
};
---
<Base
  title={pageTitle}
  description={pageDesc}
  lang="en"
  canonical="/en/index.html"
  alternates={[{ href: '/index.html', hrefLang: 'zh-Hans' }]}
  languageToggle={{ href: '/index.html', label: '中文', ariaLabel: '查看中文首页' }}
  jsonLd={jsonLd}
>
  <section class="hero hero--profile" id="top">
    <div class="hero__portrait">
      <img src={portrait} alt="Kateiso portrait" loading="lazy" />
    </div>
    <div class="hero__content">
      <p class="hero__kicker">Ningbo Base · Weihai Campus</p>
      <h1>Kateiso</h1>
      <p class="hero__subtitle">I focus on AI into XR and hospitality, hoping to link up with collaborators who enjoy living systems.</p>
      <div class="hero__actions">
        <a class="button button--primary" href="/en/projects.html">Projects</a>
        <a class="button button--ghost" href="/en/contact.html">Contact</a>
      </div>
      <ul class="hero__facts">
        <li>Base: Ningbo · study in Weihai</li>
        <li>Dual degree · Lancaster University & BJTU</li>
        <li>Email <a href="mailto:C.yibo2@gmail.com">C.yibo2@gmail.com</a></li>
      </ul>
    </div>
  </section>

  <section class="section" id="timeline">
    <div class="section__intro">
      <h2>Timeline</h2>
    </div>
    <div class="timeline">
      {timeline.map((item) => (
        <article class="timeline__item">
          <span class="timeline__year">{item.year}</span>
          <p>{item.detail}</p>
        </article>
      ))}
    </div>
  </section>

  <section class="section" id="focus">
    <div class="section__intro">
      <h2>Focus areas</h2>
    </div>
    <div class="highlight-grid">
      {focusAreas.map((item) => (
        <article class="highlight-card">
          <h3><a href={item.link}>{item.title}</a></h3>
          <p>{item.summary}</p>
        </article>
      ))}
    </div>
  </section>

  {gallery.length > 0 && (
    <section class="section" id="moments">
      <div class="section__intro section__intro--split">
        <div>
          <h2>Recent visuals</h2>
          <p class="section__lede">Shared gallery from the Chinese hub.</p>
        </div>
        <a class="section__link" href="/photos.html">Explore gallery →</a>
      </div>
      <div class="gallery-grid home-gallery">
        {gallery.map((it) => (
          <figure class="gallery-item">
            {it.video ? (
              <video class="gallery-item__media" src={it.video} poster={it.image} muted playsinline preload="metadata" loop></video>
            ) : (
              <img class="gallery-item__media" src={it.image} alt={it.title} loading="lazy" />
            )}
            <figcaption class="gallery-item__meta">
              <span class="gallery-item__date">{it.date}</span>
              <span aria-hidden="true">·</span>
              <span class="gallery-item__title">{it.title}</span>
            </figcaption>
          </figure>
        ))}
      </div>
    </section>
  )}

  <section class="section section--alt" id="journal">
    <div class="section__intro section__intro--split">
      <div>
        <h2>Journal picks</h2>
        <p class="section__lede">Notes on experiments, research, and operations.</p>
      </div>
      <a class="section__link" href="/en/blog.html">Visit blog →</a>
    </div>
    {fallback && (
      <p class="notice" style="margin-bottom:var(--spacing-md);color:var(--color-text-muted);">
        English stories are coming soon. Showing Chinese ones meanwhile.
      </p>
    )}
    <div class="journal-grid">
      {posts.map((post) => (
        <article class="journal-card">
          <p class="journal-card__meta">{new Date(post.data.date).toLocaleDateString('en-US', { month: 'long', year: 'numeric' })} · {post.data.type}</p>
          <h3><a href={fallback ? `/blog/posts/${post.slug}.html` : `/en/blog/posts/${post.slug}.html`}>{post.data.title}</a></h3>
          <p class="journal-card__summary">{post.data.summary}</p>
        </article>
      ))}
    </div>
  </section>

  <section class="section" id="cta">
    <div class="contact-card">
      <p class="contact-card__label">Collaborate</p>
      <h2>Build with AI into XR & hospitality ops</h2>
      <p>Email for pilots, co-research, talks, or system walkthroughs.</p>
      <div class="contact-card__actions">
        <a class="button button--primary" href="mailto:C.yibo2@gmail.com">Email Kateiso</a>
        <a class="button button--ghost" href="/en/contact.html">More contact options</a>
      </div>
      <div class="social-links" aria-label="Social links">
        {socials.map((item) => (
          <a class="social-link" href={item.href} target={item.href.startsWith('http') ? '_blank' : undefined} rel="noopener" aria-label={item.name}>
            <img src={item.icon} alt="" aria-hidden="true" />
          </a>
        ))}
      </div>
    </div>
  </section>
</Base>
